<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>通过调用RTX接口发送报警消息 | Pyinx Blog</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="rtx,报警," />
  

  <meta name="description" content="&amp;nbsp;
一、原理：通过GET或者POST方式将需要发送的消息和RTX用户帐号，传给RTX提供的cgi接口。
##二、详细方法：
方法：GET/POST URL:/sendnotify.cgi 用法举例(IE地址栏中输入)： http://127.0.0.1:8012/sendnotify.cgi?msg=hello&amp;amp;receiver=wwjs
参数表：
receiver：接收者，用户">
<meta property="og:type" content="article">
<meta property="og:title" content="通过调用RTX接口发送报警消息">
<meta property="og:url" content="http://blog.itsir.org/2014/02/27/140/index.html">
<meta property="og:site_name" content="Pyinx Blog">
<meta property="og:description" content="&amp;nbsp;
一、原理：通过GET或者POST方式将需要发送的消息和RTX用户帐号，传给RTX提供的cgi接口。
##二、详细方法：
方法：GET/POST URL:/sendnotify.cgi 用法举例(IE地址栏中输入)： http://127.0.0.1:8012/sendnotify.cgi?msg=hello&amp;amp;receiver=wwjs
参数表：
receiver：接收者，用户">
<meta property="og:image" content="http://ww4.sinaimg.cn/bmiddle/6f6a4381gw1edy2i85vw5j207g04jmxg.jpg">
<meta property="og:updated_time" content="2015-08-06T02:38:30.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="通过调用RTX接口发送报警消息">
<meta name="twitter:description" content="&amp;nbsp;
一、原理：通过GET或者POST方式将需要发送的消息和RTX用户帐号，传给RTX提供的cgi接口。
##二、详细方法：
方法：GET/POST URL:/sendnotify.cgi 用法举例(IE地址栏中输入)： http://127.0.0.1:8012/sendnotify.cgi?msg=hello&amp;amp;receiver=wwjs
参数表：
receiver：接收者，用户">
  
  

  


  <link rel="stylesheet" href="/css/styles.css" type="text/css">
  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</head>

<body>
  <div class="content-post">
  <a class="avatar" href="/archives">
    <img src="/images/avatar.jpg" alt="" />
  </a>
  <article id="post-140" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    <a class="post-title" href="/2014/02/27/140/">通过调用RTX接口发送报警消息</a>

  </header>

  <div class="article-meta">
    <span>2014-02-27</span>

    <span> | </span>

    <span class="article-author">pyinx</span>

    <span> | </span>

    
  <span class="article-category">
    <a class="article-category-link" href="/categories/linux/">linux</a>
  </span>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>&nbsp;</p>
<h2 id="一、原理：">一、原理：</h2><p>通过GET或者POST方式将需要发送的消息和RTX用户帐号，传给RTX提供的cgi接口。</p>
<p>##<br>二、详细方法：</p>
<p>方法：GET/POST URL:/sendnotify.cgi 用法举例(IE地址栏中输入)： <a href="http://127.0.0.1:8012/sendnotify.cgi?msg=hello&amp;receiver=wwjs" target="_blank" rel="external">http://127.0.0.1:8012/sendnotify.cgi?msg=hello&amp;receiver=wwjs</a></p>
<p>参数表：</p>
<p>receiver：接收者，用户昵称，多个接收者以“,”隔开。</p>
<p>msg：消息内容 ,如需要发隐式链接,格式如: [明朝网络|<a href="http://www.mingchao.com/" target="_blank" rel="external">http://www.mingchao.com</a>]</p>
<p>title：消息提醒的标题。</p>
<p>delaytime：消息提醒框的停留时间（毫秒），0表示不自动消失。</p>
<p>okurl：成功后IE自动定位到指定的url 格式类似为：okurl=www.mingchao.com或者okurl=<a href="http://www.mingchao.com/" target="_blank" rel="external">http://www.mingchao.com</a> 注意：这里的url必须为绝对地址。</p>
<p>errurl：失败后IE自动定位到指定的url。<br>功能二：获取用户状态</p>
<p>1.调用方式：<a href="http://127.0.0.1:8012/getstatus.php?username=yangbin" target="_blank" rel="external">http://127.0.0.1:8012/getstatus.php?username=yangbin</a></p>
<p>2.参数说明： username 需要获取哪个用户的状态<br>功能三：给某个组群发RTX广播消息</p>
<p>1.调用方式：<a href="http://127.0.0.1:8012/sendnotifybydepart.php?receiverdepart=%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%E7%BB%84&amp;msg=%E5%90%83%E9%A5%AD%E4%BA%86&amp;title=%E9%80%9A%E7%9F%A5&amp;online=1&amp;delaytime=10000" title="%E9%80%9A%E7%9F%A5&amp;online=1&amp;delaytime=10000" target="_blank" rel="external">http://127.0.0.1:8012/sendnotifybydepart.php?receiverdepart=运维开发组&amp;msg=吃饭了&amp;title=通知&amp;online=1&amp;delaytime=10000</a></p>
<p>2.参数说明： receiverdepart 需要给那个部门发送消息，该部门即在RTX中看到的组织架构中的部门名</p>
<p>msg 　 消息内容 ,如需要发隐式链接,格式如: [明朝|<a href="http://www.mingchao.com/" target="_blank" rel="external">http://www.mingchao.com</a>]</p>
<p>title 消息提醒的标题。 【可省略】</p>
<p>online 是否只发在线用户，默认只发给在线用户。 【可省略】</p>
<p>delaytime 消息提醒框的停留时间（毫秒），0表示不自动消失，默认为0。 【可省略】</p>
<p>okurl 成功后IE自动定位到指定的url 格式类似为：okurl=rtx.tencent.com 或者okurl=<a href="http://tx.tencent.com/" target="_blank" rel="external">http://tx.tencent.com</a> 注意：这里的url必须为绝对地址。 【可省略】</p>
<p>errurl 　 失败后IE自动定位到指定的url。【可省略】<br>功能四：给某个群群发RTX广播消息</p>
<p>1.调用方式：<a href="http://127.0.0.1:8012/sendnotifybygroup.php?receivergroup=M4%E5%BC%80%E5%8F%91%E7%BE%A4&amp;msg=%E5%90%83%E9%A5%AD%E4%BA%86&amp;title=%E9%80%9A%E7%9F%A5&amp;online=1&amp;delaytime=10000" title="%E9%80%9A%E7%9F%A5&amp;online=1&amp;delaytime=10000" target="_blank" rel="external">http://127.0.0.1:8012/sendnotifybygroup.php?receivergroup=M4开发群&amp;msg=吃饭了&amp;title=通知&amp;online=1&amp;delaytime=10000</a></p>
<p>2.参数说明： receivergroup 需要给那个群发送广播消息，即RTX群</p>
<p>msg 　 消息内容 ,如需要发隐式链接,格式如: [明朝|<a href="http://www.mingchao.com/" target="_blank" rel="external">http://www.mingchao.com</a>]</p>
<p>title 消息提醒的标题。 【可省略】</p>
<p>online 是否只发在线用户，默认只发给在线用户。 【可省略】</p>
<p>delaytime 消息提醒框的停留时间（毫秒），0表示不自动消失，默认为0。 【可省略】</p>
<p>okurl 成功后IE自动定位到指定的url 格式类似为：okurl=rtx.tencent.com 或者okurl=<a href="http://tx.tencent.com/" target="_blank" rel="external">http://tx.tencent.com</a> 注意：这里的url必须为绝对地址。 【可省略】</p>
<p>errurl 　 失败后IE自动定位到指定的url。【可省略】</p>
<p>##<br>三、注意事项</p>
<p>(1)参数msg中如果包含中文那么需要将msg的编码方式转换成GBK或者GB2312，msg是不支持UTF-8编码方式的。</p>
<p>(2)参数msg如需要加入超链接格式为：[点我跳转|<a href="http://www.mingchao.com/" target="_blank" rel="external">http://www.mingchao.com</a>]</p>
<p>(3)参数msg中不能出现空格，如果需要空格可用【+】替代。</p>
<p>(4)如果请求的url中包含特殊字符，那么需要使用urlencode(),来对url进行编码，否则可能导致超链接显示不正常。</p>
<p>(5)发送消息是需要权限的，这个需要在RTX服务端配置才能发送消息。</p>
<p>##<br>四、建议</p>
<p>(1)对msg进行转码的时候用GBK不要用GB2312，因为GB2312支持的汉字比较少，很多比较偏的汉字会无法显示，导致消息被中断(即用户只能收到这个中断前的字符)。</p>
<p>(2)在对消息进行转码的时候，可以考虑加入参数IGNORE，即$msg=iconv(“utf-8”,”gb2312//IGNORE”,$msg)这样在转码的时候将会忽略错误字符。会将错误字符后面的继续转码。</p>
<p>(3)在RTXServer服务端的WebRoot目录下放着很多的cgi和php文件。这些文件都是可以用HTTP方式来访问的，你也可以自己编写新的cgi或者php文件，然后将其放到改目录下即可。这样将可能提供非常强大的扩展功能。</p>
<p><img src="http://ww4.sinaimg.cn/bmiddle/6f6a4381gw1edy2i85vw5j207g04jmxg.jpg" alt=""></p>
<p>&nbsp;</p>
<p>本文摘自：<a href="http://www.xuebuyuan.com/1269803.html" target="_blank" rel="external">http://www.xuebuyuan.com/1269803.html</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>

      
    </div>

    
      

    

  </div>
</article>



<section class="disqus-comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>




</div>

  
<script>
  var disqus_shortname = 'pyinx';
  
  var disqus_url = 'http://blog.itsir.org/2014/02/27/140/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"undefined"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0]
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

</body>
</html>
