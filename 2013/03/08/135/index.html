<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>[转]python截图代码（Linux+Windows） | Pyinx Blog</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="PyQT,pyGtk,python,截屏," />
  

  <meta name="description" content="## inux环境下可以参考这个示例：http://stackoverflow.com/questions/69645/take-a-screenshot-via-a-python-script-linux   这个是使用gtk库*[python] view plaincopyprint?


import gtk.gdk  
  
w = gtk.gdk.get_default_root_win">
<meta property="og:type" content="article">
<meta property="og:title" content="[转]python截图代码（Linux+Windows）">
<meta property="og:url" content="http://blog.itsir.org/2013/03/08/135/index.html">
<meta property="og:site_name" content="Pyinx Blog">
<meta property="og:description" content="## inux环境下可以参考这个示例：http://stackoverflow.com/questions/69645/take-a-screenshot-via-a-python-script-linux   这个是使用gtk库*[python] view plaincopyprint?


import gtk.gdk  
  
w = gtk.gdk.get_default_root_win">
<meta property="og:updated_time" content="2015-08-06T02:38:30.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[转]python截图代码（Linux+Windows）">
<meta name="twitter:description" content="## inux环境下可以参考这个示例：http://stackoverflow.com/questions/69645/take-a-screenshot-via-a-python-script-linux   这个是使用gtk库*[python] view plaincopyprint?


import gtk.gdk  
  
w = gtk.gdk.get_default_root_win">
  
  

  


  <link rel="stylesheet" href="/css/styles.css" type="text/css">
  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</head>

<body>
  <div class="content-post">
  <a class="avatar" href="/archives">
    <img src="/images/avatar.jpg" alt="" />
  </a>
  <article id="post-135" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    <a class="post-title" href="/2013/03/08/135/">[转]python截图代码（Linux+Windows）</a>

  </header>

  <div class="article-meta">
    <span>2013-03-08</span>

    <span> | </span>

    <span class="article-author">pyinx</span>

    <span> | </span>

    
  <span class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </span>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <div id="article_content" class="article_content" style="margin: 20px 0px 0px; padding: 0px; font-size: 14px; line-height: 26px; font-family: Arial; color: #000000; background-color: #ffffff;"><br><br>## inux环境下<br><br>可以参考这个示例：<a href="http://stackoverflow.com/questions/69645/take-a-screenshot-via-a-python-script-linux" target="_blank" rel="external">http://stackoverflow.com/questions/69645/take-a-screenshot-via-a-python-script-linux</a><br><br><em>   这个是使用gtk库<br><div class="dp-highlighter bg_python" style="margin: 18px 0px !important; padding: 1px 0px 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 982.066650390625px; overflow: hidden; background-image: url('http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/black/python.gif'); background-color: #333333; opacity: 0.6; background-position: 100% 0%; background-repeat: no-repeat no-repeat;"><br><div class="bar" style="margin: 0px; padding: 0px 0px 0px 45px; position: relative;"><br><div class="tools" style="margin: 0px; padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: #999999;"><em>*[python]</em></div></div></div></em> <a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="view plain" target="_blank" rel="external">view plain</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="copy" target="_blank" rel="external">copy</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="print" target="_blank" rel="external">print</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="?" target="_blank" rel="external">?</a><br><div style="margin: 0px; padding: 0px; position: absolute; left: 425px; top: 610px; width: 26px; height: 14px; z-index: 99;"><embed id="ZeroClipboardMovie_1" style="margin: 0px; padding: 0px;" width="26" height="14" type="application/x-shockwave-flash" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="loop" menu="false" quality="best" bgcolor="#ffffff" name="ZeroClipboardMovie_1" align="middle" allowscriptaccess="always" allowfullscreen="false" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=1&amp;width=26&amp;height=14" wmode="transparent"></div><br></div><br>

<ol>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> gtk.gdk  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">w = gtk.gdk.get_default_root_window()  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">sz = w.get_size()  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">print</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“The size of the window is %d x %d”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> % sz  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">pb = gtk.gdk.Pixbuf(gtk.gdk.COLORSPACE_RGB,<span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">False</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">8</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,sz[</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">0</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">],sz[</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">1</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">])  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">pb = pb.get_from_drawable(w,w.get_colormap(),<span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">0</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">0</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">0</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">0</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,sz[</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">0</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">],sz[</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">1</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">])  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">if</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> (pb != </span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">None</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">):  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    pb.save(<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“screenshot.png”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,</span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“png”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">)  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    <span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">print</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“Screenshot saved to screenshot.png.”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">else</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">:  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    <span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">print</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“Unable to get the screenshot.”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span><br></li>
</ol>
<ul>
<li>这是使用PyQt4库的截图代码，<strong>也可以在windows下使用</strong><div class="dp-highlighter bg_python" style="margin: 18px 0px !important; padding: 1px 0px 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 982.066650390625px; overflow: hidden; background-image: url('http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/black/python.gif'); background-color: #333333; opacity: 0.6; background-position: 100% 0%; background-repeat: no-repeat no-repeat;"><br><div class="bar" style="margin: 0px; padding: 0px 0px 0px 45px; position: relative;"><br><div class="tools" style="margin: 0px; padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: #999999;"><strong>[python]</strong> <a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="view plain" target="_blank" rel="external">view plain</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="copy" target="_blank" rel="external">copy</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="print" target="_blank" rel="external">print</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="?" target="_blank" rel="external">?</a><br><div style="margin: 0px; padding: 0px; position: absolute; left: 425px; top: 943px; width: 26px; height: 14px; z-index: 99;"><embed id="ZeroClipboardMovie_2" style="margin: 0px; padding: 0px;" width="26" height="14" type="application/x-shockwave-flash" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="loop" menu="false" quality="best" bgcolor="#ffffff" name="ZeroClipboardMovie_2" align="middle" allowscriptaccess="always" allowfullscreen="false" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=2&amp;width=26&amp;height=14" wmode="transparent"></div><br></div><br></div>
</div></li>
</ul>
<ol>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> sys  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">from</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> PyQt4.QtGui </span><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> QPixmap, QApplication  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">app = QApplication(sys.argv)  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">QPixmap.grabWindow(QApplication.desktop().winId()).save(<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘test.png’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘png’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">)  </span></span><br></li>
</ol>
<h2 id="Windows环境下"><a style="margin: 0px; padding: 0px; color: #ca0000;" name="t1"></a>Windows环境下</h2><div style="margin: 0px; padding: 0px;"><br><div class="dp-highlighter bg_python" style="margin: 18px 0px !important; padding: 1px 0px 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 982.066650390625px; overflow: hidden; background-image: url('http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/black/python.gif'); background-color: #333333; opacity: 0.6; background-position: 100% 0%; background-repeat: no-repeat no-repeat;"><br><div class="bar" style="margin: 0px; padding: 0px 0px 0px 45px; position: relative;"><br><div class="tools" style="margin: 0px; padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: #999999;"><strong>[python]</strong> <a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="view plain" target="_blank" rel="external">view plain</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="copy" target="_blank" rel="external">copy</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="print" target="_blank" rel="external">print</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="?" target="_blank" rel="external">?</a><br><div style="margin: 0px; padding: 0px; position: absolute; left: 425px; top: 1132px; width: 26px; height: 14px; z-index: 99;"><embed id="ZeroClipboardMovie_3" style="margin: 0px; padding: 0px;" width="26" height="14" type="application/x-shockwave-flash" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="loop" menu="false" quality="best" bgcolor="#ffffff" name="ZeroClipboardMovie_3" align="middle" allowscriptaccess="always" allowfullscreen="false" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=3&amp;width=26&amp;height=14" wmode="transparent"></div><br></div><br></div>

<ol>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> ImageGrab  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">img = ImageGrab.grab()  </span></li>
<li><p><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">img.save(<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘test.jpg’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,</span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘JPEG’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">)  </span></span><br></p></li></ol></div><br>以上代码都是全屏截图的。下面介绍一下窗口截图的操作，暂时只有windows下的，linux的X11还要研究一下。</div><p></p>
<div style="margin: 0px; padding: 0px;">windows窗口有句柄的概念，通过句柄，我们可以知道这个句柄指向的窗口大小，位置等坐标信息。那么使用PIL中的ImageGrab库或Qt的QPixmap类都可以获取这个范围内的图像。前提是需要截图的部分在窗口最顶层，可以直接看到。</div><br><div style="margin: 0px; padding: 0px;">原理就是这些了，下面给一个示例，也是从网上找出来并修改的：</div><br><div style="margin: 0px; padding: 0px;">Qt版本：</div><br><div style="margin: 0px; padding: 0px;"><br><div class="dp-highlighter bg_python" style="margin: 18px 0px !important; padding: 1px 0px 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 982.066650390625px; overflow: hidden; background-image: url('http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/black/python.gif'); background-color: #333333; opacity: 0.6; background-position: 100% 0%; background-repeat: no-repeat no-repeat;"><br><div class="bar" style="margin: 0px; padding: 0px 0px 0px 45px; position: relative;"><br><div class="tools" style="margin: 0px; padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: #999999;"><strong>[python]</strong> <a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="view plain" target="_blank" rel="external">view plain</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="copy" target="_blank" rel="external">copy</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="print" target="_blank" rel="external">print</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="?" target="_blank" rel="external">?</a><br><div style="margin: 0px; padding: 0px; position: absolute; left: 425px; top: 1381px; width: 26px; height: 14px; z-index: 99;"><embed id="ZeroClipboardMovie_4" style="margin: 0px; padding: 0px;" width="26" height="14" type="application/x-shockwave-flash" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="loop" menu="false" quality="best" bgcolor="#ffffff" name="ZeroClipboardMovie_4" align="middle" allowscriptaccess="always" allowfullscreen="false" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=4&amp;width=26&amp;height=14" wmode="transparent"></div><br></div><br></div>

<li><p><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="comment" style="margin: 0px; padding: 0px; border: none; color: #cccccc; background-color: inherit;"># -<em>- coding: cp936 -</em>-</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span></p>
</li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> sys  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> os  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> ctypes  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">from</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> PyQt4.QtGui </span><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> QPixmap, QApplication  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="comment" style="margin: 0px; padding: 0px; border: none; color: #cccccc; background-color: inherit;">#构造RECT结构体</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">class</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> RECT(ctypes.Structure):  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    <em>fields</em> = [(<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘left’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, ctypes.c_long),  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">                (<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘top’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, ctypes.c_long),  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">                (<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘right’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, ctypes.c_long),  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">                (<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘bottom’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, ctypes.c_long)]  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    <span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">def</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> <strong>str</strong>(</span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">):  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">        <span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">return</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> str((</span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">.left, </span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">.top, </span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">.right, </span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">.bottom))  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">app = QApplication(sys.argv)  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">HWND = ctypes.windll.user32.FindWindowA(<span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">None</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“window title”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">)  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">if</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> HWND == </span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">None</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">:  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    <span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">print</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“找不到窗口”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    quit()  </span></li>
<li><p><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">QPixmap.grabWindow(HWND).save(<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘c:/test.png’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘png’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">)  </span></span><br></p></li></div><p></p>
<div style="margin: 0px; padding: 0px;"></div><br>PIL版本：<br><pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; white-space: pre-wrap; word-wrap: break-word;"></pre><br></div><br><div style="margin: 0px; padding: 0px;"><br><div class="dp-highlighter bg_python" style="margin: 18px 0px !important; padding: 1px 0px 0px; font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px; width: 982.066650390625px; overflow: hidden; background-image: url('http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/images/black/python.gif'); background-color: #333333; opacity: 0.6; background-position: 100% 0%; background-repeat: no-repeat no-repeat;"><br><div class="bar" style="margin: 0px; padding: 0px 0px 0px 45px; position: relative;"><br><div class="tools" style="margin: 0px; padding: 3px 8px 10px 10px; font-size: 9px; line-height: normal; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; color: silver; border-left-width: 3px; border-left-style: solid; border-left-color: #999999;"><strong>[python]</strong> <a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="view plain" target="_blank" rel="external">view plain</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="copy" target="_blank" rel="external">copy</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="print" target="_blank" rel="external">print</a><a href="http://blog.csdn.net/jt6562/article/details/6768153#" title="?" target="_blank" rel="external">?</a><br><div style="margin: 0px; padding: 0px; position: absolute; left: 425px; top: 1814px; width: 26px; height: 14px; z-index: 99;"><embed id="ZeroClipboardMovie_5" style="margin: 0px; padding: 0px;" width="26" height="14" type="application/x-shockwave-flash" src="http://static.blog.csdn.net/scripts/ZeroClipboard/ZeroClipboard.swf" loop="loop" menu="false" quality="best" bgcolor="#ffffff" name="ZeroClipboardMovie_5" align="middle" allowscriptaccess="always" allowfullscreen="false" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=5&amp;width=26&amp;height=14" wmode="transparent"></div><br></div><br></div>

<li><p><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="comment" style="margin: 0px; padding: 0px; border: none; color: #cccccc; background-color: inherit;"># -<em>- coding: cp936 -</em>-</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span></p>
</li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> ctypes  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">import</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> ImageGrab  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="comment" style="margin: 0px; padding: 0px; border: none; color: #cccccc; background-color: inherit;">#构造RECT结构体</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">class</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> RECT(ctypes.Structure):  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    <em>fields</em> = [(<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘left’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, ctypes.c_long),  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">                (<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘top’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, ctypes.c_long),  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">                (<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘right’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, ctypes.c_long),  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">                (<span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">‘bottom’</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, ctypes.c_long)]  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    <span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">def</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> <strong>str</strong>(</span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">):  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">        <span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">return</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> str((</span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">.left, </span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">.top, </span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">.right, </span><span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">self</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">.bottom))  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">HWND = ctypes.windll.user32.FindWindowA(<span class="special" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">None</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">, </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“window title”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">)  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">print</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> HWND  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">if</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> HWND == </span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">0</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">:  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    <span class="keyword" style="margin: 0px; padding: 0px; border: none; color: #66ccff; background-color: inherit; font-weight: bold;">print</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;"> </span><span class="string" style="margin: 0px; padding: 0px; border: none; color: #ff9900; background-color: inherit;">“找不到窗口”</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">    quit()  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">rect =RECT()  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">ctypes.windll.user32.GetWindowRect(HWND,ctypes.byref(rect))  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;"><span class="comment" style="margin: 0px; padding: 0px; border: none; color: #cccccc; background-color: inherit;">#去掉状态栏</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">rangle = (rect.left+<span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">2</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,rect.top+</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">2</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,rect.right-</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">2</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">,rect.bottom-</span><span class="number" style="margin: 0px; padding: 0px; border: none; background-color: inherit;">2</span><span style="margin: 0px; padding: 0px; border: none; background-color: inherit;">)  </span></span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">im = ImageGrab.grab(rangle)  </span></li>
<li><span style="margin: 0px; padding: 0px; border: none; color: #ffffff; background-color: inherit;">im.show()  </span><br></li></div><br></div><br><div></div><br><div>转自：<a href="http://blog.csdn.net/jt6562/article/details/6768153" target="_blank" rel="external">http://blog.csdn.net/jt6562/article/details/6768153</a></div>


      
    </div>

    
      

    

  </div>
</article>



<section class="disqus-comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>




</div>

  
<script>
  var disqus_shortname = 'pyinx';
  
  var disqus_url = 'http://blog.itsir.org/2013/03/08/135/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"undefined"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0]
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

</body>
</html>
